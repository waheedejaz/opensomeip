@startuml v_model_test_strategy
' SOME/IP Stack V-Model Test Strategy
' Based on Open SOME/IP Specification

!define RECTANGLE_COLOR #E8F5E9
!define ARROW_COLOR #1976D2
!define TEST_COLOR #FFF3E0
!define CRITICAL_COLOR #FFEBEE

title SOME/IP Stack V-Model Test Strategy\nBased on Open SOME/IP Specification

skinparam backgroundColor #FFFFFF
skinparam shadowing false
skinparam roundcorner 10

skinparam rectangle {
    BackgroundColor RECTANGLE_COLOR
    BorderColor #388E3C
}

skinparam note {
    BackgroundColor TEST_COLOR
    BorderColor #F57C00
}

' Left side - Development
rectangle "**1. Requirements Analysis**\n(Open SOME/IP Specification)" as REQ #E3F2FD {
    rectangle "Core Protocol\n487 requirements" as REQ1
    rectangle "Message Format\nSerialization\nTransport Bindings" as REQ2
    rectangle "SD Protocol\nTP Protocol\nError Handling" as REQ3
}

rectangle "**2. System Design**\nArchitecture Definition" as SYS #E8F5E9 {
    rectangle "Component Model" as SYS1
    rectangle "Interface Definitions" as SYS2
    rectangle "Data Flow Design" as SYS3
}

rectangle "**3. Architecture Design**\nModule Structure" as ARCH #FFF9C4 {
    rectangle "someip-core" as ARCH1
    rectangle "someip-sd" as ARCH2
    rectangle "someip-tp" as ARCH3
    rectangle "someip-transport" as ARCH4
}

rectangle "**4. Module Design**\nComponent Specifications" as MOD #FFECB3 {
    rectangle "Message\nSerializer\nDeserializer" as MOD1
    rectangle "SdClient\nSdServer" as MOD2
    rectangle "TpSegmenter\nTpReassembler" as MOD3
}

rectangle "**5. Coding**\nImplementation" as CODE #FFE0B2 {
    rectangle "C++ Source Code" as CODE1
    rectangle "include/*.h\nsrc/*.cpp" as CODE2
}

' Right side - Testing
rectangle "**5. Unit Testing**\n(Level 1)" as UT #FFEBEE {
    note right
        **Test Files:**
        - test_message.cpp
        - test_serialization.cpp
        - test_session_manager.cpp
        - test_endpoint.cpp
        - test_tp.cpp
        - test_sd.cpp
        
        **Coverage Target:** â‰¥95%
        **Requirements:** 
        - feat_req_someip_44-103
        - feat_req_someip_167-299
        - feat_req_someiptp_759-820
    end note
}

rectangle "**4. Component Testing**\n(Level 2)" as CT #FCE4EC {
    note right
        **Test Scope:**
        - Message round-trip
        - Transport components
        - TP segmentation/reassembly
        - RPC client/server
        - SD client/server
        
        **Framework:** GTest + pytest
    end note
}

rectangle "**3. Integration Testing**\n(Level 3)" as IT #F3E5F5 {
    note right
        **Test Scope:**
        - End-to-end RPC
        - Service Discovery flow
        - Event publish/subscribe
        - TP with transport
        
        **Location:**
        tests/integration/
        tests/test_integration.py
    end note
}

rectangle "**2. System Testing**\n(Level 4)" as ST #E8EAF6 {
    note right
        **Test Scope:**
        - Protocol conformance
        - Behavior conformance
        - Robustness testing
        - Performance testing
        
        **Location:**
        tests/specification_test.py
        tests/conformance_test.py
    end note
}

rectangle "**1. Acceptance Testing**\n(Level 5)" as AT #E3F2FD {
    note right
        **Acceptance Criteria:**
        - Protocol interoperability
        - Specification compliance
        - Functional completeness
        - Quality attributes
        - Documentation
        
        **Validation:** 
        Cross-stack testing
        Wireshark verification
    end note
}

' Vertical relationships (development flow)
REQ --> SYS
SYS --> ARCH
ARCH --> MOD
MOD --> CODE

' Horizontal relationships (test traceability)
REQ .right.> AT : "validates"
SYS .right.> ST : "validates"
ARCH .right.> IT : "validates"
MOD .right.> CT : "validates"
CODE .right.> UT : "validates"

' Testing hierarchy (bottom-up)
UT -up-> CT : "informs"
CT -up-> IT : "enables"
IT -up-> ST : "enables"
ST -up-> AT : "enables"

' Legend
legend right
    |= Color |= Phase |
    |<#E3F2FD> | Requirements/Acceptance |
    |<#E8F5E9> | System Design/Testing |
    |<#FFF9C4> | Architecture |
    |<#FFECB3> | Module Design |
    |<#FFE0B2> | Coding |
    |<#FFEBEE> | Unit Testing |
    |<#FCE4EC> | Component Testing |
    |<#F3E5F5> | Integration Testing |
    |<#E8EAF6> | System Testing |
endlegend

footer Open SOME/IP Specification v2025 | Test Plan v1.0

@enduml

